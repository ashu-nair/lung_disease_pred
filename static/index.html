<!DOCTYPE html>
<html>
<head>
  <title>Medical AI Demo</title>
  <style>
    body { font-family: Arial, sans-serif; }
    img { max-width: 500px; margin-top: 10px; display: block; }
    .result {
      margin-top: 15px;
      font-size: 22px;
      font-weight: bold;
    }
    .section { margin-bottom: 40px; }
  </style>
</head>

<body>

<h1>Medical AI Demo</h1>

<div class="section">
  <h2>CT Scan Prediction</h2>
  <input type="file" id="ctFile">
  <button type="button" onclick="predictCT()">Predict CT</button>

  <div id="ctResult" class="result"></div>
  <img id="ctImage">
</div>

<hr>

<div class="section">
  <h2>X-ray Prediction</h2>
  <input type="file" id="xrayFile">
  <button type="button" onclick="predictXray()">Predict X-ray</button>

  <div id="xrayResult" class="result"></div>
  <img id="xrayImage">
</div>

<script>
console.log("JS loaded"); // debug line

async function predictCT() {
  const fileInput = document.getElementById("ctFile");
  if (!fileInput.files.length) {
    alert("Please upload CT image");
    return;
  }

  const formData = new FormData();
  formData.append("file", fileInput.files[0]);

  const res = await fetch("/predict/ct", {
    method: "POST",
    body: formData
  });

  const data = await res.json();
  const confidence = data.confidence.toFixed(2);

  document.getElementById("ctResult").innerText =
    `${data.prediction} (${confidence}%)`;

  document.getElementById("ctImage").src =
    URL.createObjectURL(fileInput.files[0]);
}

async function predictXray() {
  const fileInput = document.getElementById("xrayFile");
  if (!fileInput.files.length) {
    alert("Please upload X-ray image");
    return;
  }

  const formData = new FormData();
  formData.append("file", fileInput.files[0]);

  const res = await fetch("/predict/xray", {
    method: "POST",
    body: formData
  });

  const data = await res.json();
  const confidence = data.confidence.toFixed(2);

  document.getElementById("xrayResult").innerText =
    `${data.prediction} (${confidence}%)`;

  document.getElementById("xrayImage").src =
    URL.createObjectURL(fileInput.files[0]);
}
</script>

</body>
</html>
